# AI2651 Project 1 Task 2
- 频域特征
- 统计学习分类器

## 文件架构
> 只罗列与任务二相关的代码。由于很多路径在代码中是以相对路径硬编码，请尽量确保文件架构与下文罗列的一致。
> 在 https://github.com/YBRua/2651Project1_VAD 可以找到两个任务的全部完整代码（不含数据集）。

- data
  - `dev_label.txt`
  - `train_label.txt`
- wavs
  - train
  - dev
  - test
- vad
  - classifiers
    - `dualGMM`：任务二使用的基于GMM的分类器
  - features
    - `spectral_features`：提取频域特征的工具函数（主要为mfcc）
  - task2
    - feature_engineering：空文件夹。在任务二的特征工程中使用（存放各种提取出的特征）。要正常复现特征选择的过程，请确保这一文件夹存在。
    - `pipeline`：任务二的训练、验证、测试流程函数
  - `data_loader`：任务一和任务二中，将语音信号转为分类器所用特征的函数
  - `evaluate`：助教提供的模型评估指标
  - `vad_utils`：助教提供的工具函数
- `feature_engineering.py`：特征选择的相关代码。
- `model_selection.py`：模型调参的代码。
- `task2.py`：任务二的训练-评估-测试的完整流程。

## 如何运行
### 运行之前
- 请参照[文件架构](#文件架构)确保所有文件相对路径准确。
- 请确保“wavs”和“data”两个文件夹在当前目录下。
  - 考虑到训练时特征提取工作可能耗时较长（训练集约60分钟，开发集约10分钟），可以从以下链接下载训练集和开发集提取好的特征的二进制文件，将其存放在`./data/`文件夹下即可。
    - 训练集：[jBox](https://jbox.sjtu.edu.cn/l/tF2HwY)
    - 开发集：[jBox](https://jbox.sjtu.edu.cn/l/YFK4e0)

### 可运行文件
- 要复现任务二的训练、评估、测试的完整流程，请运行[`task2.py`](task2.py)，这是任务二的训练-评估-测试的完整流程。在没有预加载训练集和测试集的前提下，完整运行这段代码需要**至少90分钟**；
  - 会在`./data/`文件夹下生成训练集和测试集的二进制文件，总大小约2.1GB。
  - 会在`./vad/task2/`文件夹下生成当前训练好的模型。
  - 在测试集上的预测结果`test_label_task2.txt`同样存放在`./vad/task2/`文件夹下。
- 要复现任务二中特征选择的评估过程，请运行[`feature_engineering.py`](feature_engineering.py)，这任务二中特征的选择。完整运行这段代码**需要很长时间，且会占用较大存储空间**。需要强调的是，这段代码在完成时**设计有些失败、且缺乏合理优化**[^丢人]，在实验时**只使用了训练集的前1500条**，如果尝试使用全部的训练集进行训练，**可能会遇到内存不足**。
- 要复现任务二中的模型参数调整过程，请选择[`model_selection.py`](model_selection.py)，这是任务二的模型参数选择。完整运行这段代码同样需要较长时间。
- 本次任务的代码固定了随机种子，因此运行结果应该与技术报告一致。

[^丢人]: 明明是电院的学生，却写不出个像样的代码呢。真丢人。（x